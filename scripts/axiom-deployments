#!/usr/bin/env bash
# List configured Axiom deployments WITHOUT exposing secrets
# Usage: axiom-deployments

set -uo pipefail

CONFIG_FILE="$HOME/.axiom.toml"

if [[ ! -f "$CONFIG_FILE" ]]; then
  echo "No Axiom config found at $CONFIG_FILE"
  exit 1
fi

deployments=$(grep -E '^\[deployments\.' "$CONFIG_FILE" 2>/dev/null | sed 's/\[deployments\.//; s/\]//' || true)

if [[ -z "$deployments" ]]; then
  echo "No deployments configured in $CONFIG_FILE"
  exit 0
fi

echo "Configured deployments:"
echo "$deployments" | while read -r name; do
  echo "  - $name"
done
